version: '3.8'

services:
  # å¾Œç«¯æœå‹™
  backend:
    container_name: meetro_backend
    build:
      context: ./backend 
      dockerfile: Dockerfile
    ports:
      - "8001:8000"
    volumes:
      # 1. ç¨‹å¼ç¢¼ç†±é‡è¼‰ï¼šå°‡æœ¬åœ°çš„ backend/ ç›®éŒ„æ˜ å°„åˆ°å®¹å™¨çš„ /app/backend/
      # ğŸš¨ é€™æœƒå°‡æ‰€æœ‰ç¨‹å¼ç¢¼åŒæ­¥åˆ°å®¹å™¨å…§ï¼ŒåŒæ™‚ä¹Ÿæœƒå°‡ meetro.db æª”æ¡ˆåŒæ­¥å‡ºä¾†
      - ./backend:/app/backend 
      
      # 2. ç¢ºä¿ .db æª”æ¡ˆå­˜åœ¨ï¼š
      # ç•¶å®¹å™¨å•Ÿå‹•æ™‚ï¼Œå¦‚æœ ./backend/meetro.db ä¸å­˜åœ¨ï¼ŒDocker æœƒå‰µå»ºå®ƒã€‚
      # é€™é€šå¸¸æ˜¯è¶³å¤ çš„ï¼Œåªè¦æ‚¨åœ¨å•Ÿå‹•å‰åˆªé™¤æœ¬åœ°éŒ¯èª¤çš„ meetro.db "è³‡æ–™å¤¾"ã€‚
      
    command: uvicorn backend.main:app --host 0.0.0.0 --port 8000 --reload

  # å‰ç«¯æœå‹™
  frontend:
    container_name: meetro_frontend
    build:
      context: ./frontend
      dockerfile: Dockerfile.dev
    ports:
      - "8080:8080"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    command: npm run dev -- --host 0.0.0.0 --port 8080
    depends_on:
      - backend
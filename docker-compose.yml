version: '3.8'

services:
  # --------------------
  # 1. Frontend Service (Vue 3 / Vite Development Mode)
  # --------------------
  frontend:
    container_name: meetro_frontend
    build:
      context: .
      # 使用我們專為開發模式創建的 Dockerfile
      dockerfile: frontend/Dockerfile.dev 
    # 映射 Vite Dev Server 的預設端口 5173
    ports:
      - "5173:5173"
    # Volume Mounts 實現 HMR
    volumes:
      # 將本地 frontend 目錄映射到容器的 /app，實現原始碼同步
      - ./frontend:/app
      # 避免將本地 host 的 node_modules 覆蓋容器內部的，保持依賴一致
      - /app/node_modules
    # 運行 Vite 開發伺服器，並監聽所有網路接口
    command: npm run dev -- --host 0.0.0.0
    depends_on:
      - backend

  # --------------------
  # 2. Backend Service (假設是 Python/Django)
  # --------------------
  backend:
    build:
      context: .
      dockerfile: backend/Dockerfile
    container_name: meetro-backend
    volumes:
      - ./backend:/app
    ports:
      - "8000:8000"
    command: python manage.py runserver 0.0.0.0:8000
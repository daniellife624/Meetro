version: '3.8'

services:
  # å¾Œç«¯æœå‹™
  backend:
    container_name: meetro_backend
    build:
      context: ./backend 
      dockerfile: Dockerfile
    ports:
      - "8001:8000"
    volumes:
      # 1. ç¨‹å¼ç¢¼ç†±é‡è¼‰ (ç¶­æŒä¸è®Š)
      - ./backend:/app/backend 
      
      # 2. ğŸš¨ é—œéµä¿®æ­£ï¼šæ˜ å°„è³‡æ–™åº« Volume åˆ° /tmp/
      # é€™æœƒå°‡ /tmp/ ç›®éŒ„ä¸‹çš„æ‰€æœ‰å…§å®¹ (åŒ…æ‹¬ meetro.db) æŒä¹…åŒ–åˆ° Docker å‘½å Volume ä¸­ã€‚
      - meetro_data:/tmp/
      
    command: uvicorn backend.main:app --host 0.0.0.0 --port 8000 --reload

  # å‰ç«¯æœå‹™
  frontend:
    container_name: meetro_frontend
    build:
      context: ./frontend
      dockerfile: Dockerfile.dev
    ports:
      - "8080:8080"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    command: npm run dev -- --host 0.0.0.0 --port 8080
    depends_on:
      - backend

# ğŸš¨ æ–°å¢å‘½å Volume å€å¡Š
volumes:
  meetro_data: